[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "eBird Best Practices: Modeling Relative Abundance",
    "section": "",
    "text": "Introduction\nThe contents of this website comprise the notes for a workshop on best practices for using eBird data presented at the Australasian Ornithological Conference 2023 on Monday November 27 in Brisbane, Australia. The workshop is divided into two lessons covering:"
  },
  {
    "objectID": "index.html#sec-intro-setup",
    "href": "index.html#sec-intro-setup",
    "title": "eBird Best Practices: Modeling Relative Abundance",
    "section": "Setup",
    "text": "Setup\nThis workshop is intended to be interactive. All examples are written in the R programming language, and the instructor will work through the examples in real time, while the attendees are encouraged following along by writing the same code. To ensure we can avoid any unnecessary delays, please follow these setup instructions prior to the workshop\n\nDownload the data package [TODO] for this workshop. This data package contains a variety of datasets used throughout the three lessons.\nDownload and install the latest version of R. You must have R version 4.0.0 or newer to follow along with this workshop\nDownload and install the latest version of RStudio. RStudio is not required for this workshop; however, the instructors will be using it and you may find it easier to following along if you’re working in the same environment.\nCreate an RStudio project for working through the examples in this workshop. Move all the files from the data package so they’re in a data/ subdirectory of the project directory.\nThe lessons in this workshop use a variety of R packages. To install all the necessary packages, run the following code\n\n\nif (!requireNamespace(\"remotes\", quietly = TRUE)) {\n  install.packages(\"remotes\")\n}\nremotes::install_github(\"ebird/ebird-best-practices\")\n\n\nEnsure all packages are updated to their most recent versions by clicking on the Update button on the Packages tab in RStudio."
  },
  {
    "objectID": "index.html#sec-intro-tidyverse",
    "href": "index.html#sec-intro-tidyverse",
    "title": "eBird Best Practices: Modeling Relative Abundance",
    "section": "Tidyverse",
    "text": "Tidyverse\nThroughout this book, we use packages from the Tidyverse, an opinionated collection of R packages designed for data science. Packages such as ggplot2, for data visualization, and dplyr, for data manipulation, are two of the most well known Tidyverse packages; however, there are many more. We’ll try to explain any functions as they come up; however, for a good general resource on working with data in R using the Tidyverse see the free online book R for Data Science by Hadley Wickham.\nThe one piece of the Tidyverse that we will cover up front is the pipe operator %&gt;%. The pipe takes the expression to the left of it and “pipes” it into the first argument of the expression on the right.\n\nlibrary(dplyr)\n\n# without pipe\nmean(1:10)\n#&gt; [1] 5.5\n\n# with pipe\n1:10 %&gt;% mean()\n#&gt; [1] 5.5\n\nThe pipe can code significantly more readable by avoiding nested function calls, reducing the need for intermediate variables, and making sequential operations read left-to-right. For example, to add a new variable to a data frame, then summarize using a grouping variable, the following are equivalent:\n\n# intermediate variables\nmtcars_kg &lt;- mutate(mtcars, wt_kg = 454 * wt)\nmtcars_grouped &lt;- group_by(mtcars_kg, cyl)\nsummarize(mtcars_grouped, wt_kg = mean(wt_kg))\n#&gt; # A tibble: 3 × 2\n#&gt;     cyl wt_kg\n#&gt;   &lt;dbl&gt; &lt;dbl&gt;\n#&gt; 1     4 1038.\n#&gt; 2     6 1415.\n#&gt; 3     8 1816.\n\n# nested function calls\nsummarize(\n  group_by(\n    mutate(mtcars, wt_kg = 454 * wt),\n    cyl\n  ),\n  wt_kg = mean(wt_kg)\n)\n#&gt; # A tibble: 3 × 2\n#&gt;     cyl wt_kg\n#&gt;   &lt;dbl&gt; &lt;dbl&gt;\n#&gt; 1     4 1038.\n#&gt; 2     6 1415.\n#&gt; 3     8 1816.\n\n# pipes\nmtcars %&gt;% \n  mutate(wt_kg = 454 * wt) %&gt;% \n  group_by(cyl) %&gt;% \n  summarize(wt_kg = mean(wt_kg))\n#&gt; # A tibble: 3 × 2\n#&gt;     cyl wt_kg\n#&gt;   &lt;dbl&gt; &lt;dbl&gt;\n#&gt; 1     4 1038.\n#&gt; 2     6 1415.\n#&gt; 3     8 1816.\n\n\n\n\n\n\n\nExercise\n\n\n\nRewrite the following code using pipes:\n\nset.seed(1)\nround(log(runif(10, min = 0.5)), 1)\n#&gt;  [1] -0.5 -0.4 -0.2  0.0 -0.5 -0.1  0.0 -0.2 -0.2 -0.6\n\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\n\nset.seed(1)\nrunif(10, min = 0.5) %&gt;% \n  log() %&gt;% \n  round(digits = 1)\n#&gt;  [1] -0.5 -0.4 -0.2  0.0 -0.5 -0.1  0.0 -0.2 -0.2 -0.6"
  },
  {
    "objectID": "ebird.html#sec-ebird-erd",
    "href": "ebird.html#sec-ebird-erd",
    "title": "1  eBird Data",
    "section": "1.1 eBird Reference Dataset (ERD)",
    "text": "1.1 eBird Reference Dataset (ERD)\nThe eBird Reference Dataset (ERD) is a subset of the full eBird database created annually for Status and Trends modeling. Only semi-structured (complete checklists with effort information) traveling and stationary counts from the last 15 years are included in the ERD and we assign a set of environmental variables assigned to checklist.\n\n\n\n\n\n\nTip\n\n\n\nThis workshop will only cover the eBird Reference Dataset (ERD). For access to the full eBird dataset updated monthly, you’ll need to work with the eBird Basic Dataset (EBD). For details on working with the EBD consult the eBird Best Practices book. Some of the advantages and disadvantages of the two datasts are:\n\n\n\n\n\n\n\n\n\neBird Reference Dataset (ERD)\neBird Basic Dataset (EBD)\n\n\n\n\ncontains only complete traveling and stationary counts from the last 15 years\ncontains all eBird observations except for sensitive species\n\n\nupdated annually\nupdated monthly\n\n\nenvironmental variables assigned to checklists\ncomplete set of variables from the eBird database including checklist comments, species comments, breeding codes, etc.\n\n\nformat is easier to work with in R\n\n\n\n\n\n\n\n\nThe ERD is distributed in two parts: observation data and checklist data. In the observation dataset, each row corresponds to the sighting of a single species on a checklist, including the count and any other species-level information. In the checklist dataset, each row corresponds to a checklist, including the date, time, location, effort (e.g. distance traveled, time spent, etc.), and any additional checklist-level information.\nFor this workshop, and extract of the ERD is provided for Chile in the workshop data package. The observations and checklsits datasets are provided in parquet format, an open source standard for efficient storage and retrieval of tabular data. If you haven’t already done so, following the instructions in the Introduction to create an RStudio project and download the workshop data package. The parquet files should be located at:\ndata/ebird_observations_chile_2021.parquet\ndata/ebird_checklists_chile_2021.parquet\nLet’s start by reading these two datasets into R using the arrow package and exploring them. We’ll start with the checklist dataset.\n\nlibrary(arrow)\nlibrary(auk)\nlibrary(dplyr)\nlibrary(ebirdst)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(terra)\n\nchecklists &lt;- read_parquet(\"data/ebird_checklists_chile_2021.parquet\")\nglimpse(checklists)\n#&gt; Rows: 186,908\n#&gt; Columns: 98\n#&gt; $ checklist_id                     &lt;int&gt; 100062145, 100164965, 100241802, 1003…\n#&gt; $ observer_id                      &lt;int&gt; 796344, 2898939, 1676221, 185941, 534…\n#&gt; $ loc_id                           &lt;chr&gt; \"Trax_S100062145\", \"L6626679\", \"Trax_…\n#&gt; $ longitude                        &lt;dbl&gt; -71.5, -71.0, -73.1, -70.2, -71.4, -7…\n#&gt; $ latitude                         &lt;dbl&gt; -32.9, -35.6, -40.6, -33.4, -32.7, -3…\n#&gt; $ is_stationary                    &lt;dbl&gt; 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1…\n#&gt; $ year                             &lt;int&gt; 2021, 2021, 2021, 2012, 2021, 2021, 2…\n#&gt; $ day_of_year                      &lt;dbl&gt; 363, 365, 361, 52, 355, 360, 52, 55, …\n#&gt; $ hours_of_day                     &lt;dbl&gt; 10.95, 12.58, 16.05, 10.50, 9.70, 8.3…\n#&gt; $ solar_noon_diff_mid              &lt;dbl&gt; -2.805, 1.778, 2.178, -2.936, -3.771,…\n#&gt; $ effort_hours                     &lt;dbl&gt; 0.134, 6.000, 0.084, 1.000, 0.567, 1.…\n#&gt; $ effort_distance_km               &lt;dbl&gt; 0.340, 10.000, 0.000, 1.000, 0.000, 0…\n#&gt; $ effort_speed_kmph                &lt;dbl&gt; 2.5373, 1.6667, 0.0000, 1.0000, 0.000…\n#&gt; $ number_observers                 &lt;int&gt; 1, 2, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1…\n#&gt; $ cds_u10                          &lt;dbl&gt; 1.697, 3.316, 0.665, 1.505, 1.937, 0.…\n#&gt; $ cds_v10                          &lt;dbl&gt; -3.1903, -1.0040, 3.4476, 0.5027, -1.…\n#&gt; $ cds_d2m                          &lt;dbl&gt; 12.541, 5.630, 13.361, -0.621, 12.222…\n#&gt; $ cds_t2m                          &lt;dbl&gt; 14.78, 19.96, 25.15, 12.15, 14.30, 11…\n#&gt; $ cds_hcc                          &lt;dbl&gt; 0.00000, 0.00000, 0.00000, 0.00000, 0…\n#&gt; $ cds_i10fg                        &lt;dbl&gt; 7.26, 12.81, 8.13, 8.37, 5.12, 4.71, …\n#&gt; $ cds_mcc                          &lt;dbl&gt; 0.0000, 0.0000, 0.6003, 0.0000, 0.000…\n#&gt; $ cds_lcc                          &lt;dbl&gt; 0.95340, 0.00000, 0.61487, 0.00000, 0…\n#&gt; $ cds_sf                           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ cds_rf                           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ cds_slc                          &lt;dbl&gt; 65.10, -30.67, -67.19, -41.09, 33.80,…\n#&gt; $ cds_msl                          &lt;dbl&gt; 101779, 101232, 101667, 101732, 10144…\n#&gt; $ eastness_1km_median              &lt;dbl&gt; -0.00411, 0.00732, 0.01700, 0.04960, …\n#&gt; $ eastness_1km_sd                  &lt;dbl&gt; 0.2935, 0.2253, 0.1927, 0.1467, 0.244…\n#&gt; $ eastness_90m_median              &lt;dbl&gt; -3.69e-02, 4.44e-02, -1.63e-03, 3.76e…\n#&gt; $ eastness_90m_sd                  &lt;dbl&gt; 0.04190, 0.25816, 0.02712, 0.28047, 0…\n#&gt; $ northness_1km_median             &lt;dbl&gt; -0.169959, 0.052624, 0.505542, 0.0875…\n#&gt; $ northness_1km_sd                 &lt;dbl&gt; 0.1812, 0.2881, 0.2597, 0.2418, 0.225…\n#&gt; $ northness_90m_median             &lt;dbl&gt; 5.68e-03, -5.46e-02, 9.70e-03, -2.38e…\n#&gt; $ northness_90m_sd                 &lt;dbl&gt; 0.03915, 0.24051, 0.04255, 0.12762, 0…\n#&gt; $ elev_30m_median                  &lt;dbl&gt; 34, 2130, 38, 2833, 76, 2904, 3146, 1…\n#&gt; $ elev_30m_sd                      &lt;dbl&gt; 33.82, 117.60, 16.55, 187.94, 25.46, …\n#&gt; $ elev_250m_median                 &lt;dbl&gt; 43.00, 2137.00, 45.00, 2843.00, 50.50…\n#&gt; $ elev_250m_sd                     &lt;dbl&gt; 38.21, 101.61, 14.22, 181.66, 58.86, …\n#&gt; $ island                           &lt;dbl&gt; 30002, 30002, 30002, 30002, 30002, 30…\n#&gt; $ astwbd_fs_c1_1500_ed             &lt;dbl&gt; 3.38, 0.00, 0.00, 0.00, 5.55, 0.00, 0…\n#&gt; $ astwbd_fs_c1_1500_pland          &lt;dbl&gt; 9.07, 0.00, 0.00, 0.00, 44.78, 0.00, …\n#&gt; $ astwbd_fs_c2_1500_ed             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ astwbd_fs_c2_1500_pland          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ astwbd_fs_c3_1500_ed             &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ astwbd_fs_c3_1500_pland          &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.…\n#&gt; $ gp_rtp_1                         &lt;dbl&gt; 0, 0, 537, 0, 0, 0, 0, 0, 718, 0, 0, …\n#&gt; $ gp_rtp_2                         &lt;dbl&gt; 391.3, 0.0, 40.7, 949.0, 328.6, 0.0, …\n#&gt; $ gp_rtp_3                         &lt;dbl&gt; 0.0, 0.0, 24.3, 112.8, 0.0, 41.4, 0.0…\n#&gt; $ gp_rtp_4                         &lt;dbl&gt; 0, 0, 0, 0, 0, 181, 0, 0, 0, 0, 0, 0,…\n#&gt; $ gp_rtp_5                         &lt;dbl&gt; 0, 0, 0, 0, 0, 244, 0, 0, 0, 0, 0, 0,…\n#&gt; $ intertidal_fs_c1_1500_ed         &lt;dbl&gt; 10.045, 0.000, 0.000, 0.000, 7.137, 0…\n#&gt; $ intertidal_fs_c1_1500_pland      &lt;dbl&gt; 1.65, 0.00, 0.00, 0.00, 1.24, 0.00, 0…\n#&gt; $ ntl_mean                         &lt;dbl&gt; 1.75005, 0.00000, 28.90472, 1.67595, …\n#&gt; $ ntl_sd                           &lt;dbl&gt; 1.5571, 0.0000, 14.7225, 2.4289, 1.54…\n#&gt; $ mcd12q1_lccs1_fs_c1_1500_ed      &lt;dbl&gt; 4.20, 14.10, 0.00, 7.19, 0.00, 5.40, …\n#&gt; $ mcd12q1_lccs1_fs_c1_1500_pland   &lt;dbl&gt; 8.33, 36.73, 0.00, 63.89, 0.00, 47.22…\n#&gt; $ mcd12q1_lccs1_fs_c2_1500_ed      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c2_1500_pland   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c11_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c11_1500_pland  &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.…\n#&gt; $ mcd12q1_lccs1_fs_c12_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c12_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c13_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c13_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c14_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c14_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c15_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c15_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c16_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c16_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c21_1500_ed     &lt;dbl&gt; 3.60, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c21_1500_pland  &lt;dbl&gt; 5.56, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c22_1500_ed     &lt;dbl&gt; 13.19, 2.64, 3.08, 0.00, 6.68, 0.00, …\n#&gt; $ mcd12q1_lccs1_fs_c22_1500_pland  &lt;dbl&gt; 61.11, 6.12, 89.80, 0.00, 61.90, 0.00…\n#&gt; $ mcd12q1_lccs1_fs_c31_1500_ed     &lt;dbl&gt; 7.79, 2.20, 3.08, 0.00, 3.08, 3.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c31_1500_pland  &lt;dbl&gt; 22.22, 10.20, 10.20, 0.00, 4.76, 5.56…\n#&gt; $ mcd12q1_lccs1_fs_c32_1500_ed     &lt;dbl&gt; 0.00, 18.06, 0.00, 7.19, 0.00, 8.39, …\n#&gt; $ mcd12q1_lccs1_fs_c32_1500_pland  &lt;dbl&gt; 0.00, 46.94, 0.00, 36.11, 0.00, 47.22…\n#&gt; $ mcd12q1_lccs1_fs_c41_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c41_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c42_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c42_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c43_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c43_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs1_fs_c255_1500_ed    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c255_1500_pland &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c25_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c25_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c35_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c35_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c36_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs2_fs_c36_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs3_fs_c27_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 2.06, 0.00, 0…\n#&gt; $ mcd12q1_lccs3_fs_c27_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 2.38, 0.00, 0…\n#&gt; $ mcd12q1_lccs3_fs_c50_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs3_fs_c50_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0…\n#&gt; $ mcd12q1_lccs3_fs_c51_1500_ed     &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 2.4, 0.0, 0.…\n#&gt; $ mcd12q1_lccs3_fs_c51_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 2.78, 0…\n\nThere are a huge number of columns in this data frame. The first set of variables provide standard information about the checklist: where and when did the observation occur, what type of search was conducted, and how much search effort was expended. Two important differences exist between these variables and what you will see if you look at the raw eBird dataset: when a GPS track is available we replace the checklist or hotspot location (latitude/longitude) with the centroid of the track and the time of the checklist is expressed as the difference between the checklist midpoint and solar noon, a more ecologically meaningful quantity.\nAll the remaining variables are not collected in eBird, they’re calculated and added by the Status and Trends team based on external data sets. First, those variables beginning with cds_, provides information about the weather at the time of the observation, which can impact detectibility. This is followed by a large suite of environmental variables summarized over a 3km diameter circular neighborhood around the checklist location, including variables describing: elevation and topography, land and water cover, roads, and night time lights (a proxy for urban development). Most variables are summarized as two quantities expressing composition (what habitat is available) and configuration (how that habitat is arranged spatially). For continuous variables, such as elevation, we use the median and standard deviation. For categorical variables, such as land cover class, we use percent landcover (pland) and edge density (ed).\n\n\n\nExample of calculating percent land cover and edge density for a 3km diamter circular neighborhood centered on a checklist location. pland for each class is the percent of the circle covered by that class. To calculate ed for each class, we add up the perimeter lengths of all patches of that class, then divide by the area of the circle.\n\n\nThe land and water cover variables can be challenging to interpret based on their names alone (e.g. mcd12q1_lccs1_fs_c12_1500_pland); however, these names can be looked up in the ebirdst_predictors data frame from the ebirdst package. For example, let’s look up what mcd12q1_lccs1_fs_c12_1500_pland corresponds to.\n\nfilter(ebirdst_predictors, predictor == \"mcd12q1_lccs1_fs_c12_1500_pland\") %&gt;% \n  select(predictor, predictor_label)\n#&gt; # A tibble: 1 × 2\n#&gt;   predictor                       predictor_label                  \n#&gt;   &lt;chr&gt;                           &lt;chr&gt;                            \n#&gt; 1 mcd12q1_lccs1_fs_c12_1500_pland Evergreen Broadleaf Forests PLAND\n\n\n\n\n\n\n\nCheckpoint\n\n\n\nTake some time to explore the variables in the checklist dataset. Try looking up a variable in ebirst_predictors. Ask for help if you need clarification on the meaning of any of the variables.\n\n\nNow let’s look at the observation dataset.\n\nobservations &lt;- read_parquet(\"data/ebird_observations_chile_2021.parquet\")\nglimpse(observations)\n#&gt; Rows: 2,167,750\n#&gt; Columns: 5\n#&gt; $ checklist_id &lt;dbl&gt; 1e+08, 1e+08, 1e+08, 1e+08, 1e+08, 1e+08, 1e+08, 1e+08, 1…\n#&gt; $ species_code &lt;chr&gt; \"eardov1\", \"blcsis2\", \"gyhsif1\", \"houwre\", \"rebhaw2\", \"au…\n#&gt; $ valid        &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRU…\n#&gt; $ obs_detected &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n#&gt; $ obs_count    &lt;int&gt; 2, 4, 2, 1, 1, 3, 1, 4, 1, NA, 1, NA, NA, NA, NA, NA, NA,…\n\nThis is a much simpler dataset with only five columns:\n\nchecklist_id: unique identifier for the checklist that this observation belongs to. Allows joining the observation data to the checklist data.\nspecies_code: unique identifier for the species that this observation was made for.\nvalid: a binary variable indicating is the observation was determined to be valid (TRUE) or invalid (FALSE) by the eBird reviewers.\nobs_detected: a binary variable indicating if the species was detected (1) or not detected (0). Since this is a dataset of observations only, obs_detected is always 1; however, having this variable will become useful when we join to the checklist dataset in the next section.\nobs_count: count of the number of individuals or an NA if no count was provided (if an “X” was entered for count on the eBird checklist).\n\n\n\n\n\n\n\nTip\n\n\n\nTo look up the common name or scientific name of a species try appending the species code to the URL https://ebird.org/species/. For example, visit https://ebird.org/species/eardov1 to look up the species code eardov1. This information is also available in the ebird_taxonomy data frame in the auk package.\n\nfilter(ebird_taxonomy, species_code == \"eardov1\") %&gt;% \n  select(species_code, common_name, scientific_name, family)\n#&gt;   species_code common_name    scientific_name     family\n#&gt; 1      eardov1  Eared Dove Zenaida auriculata Columbidae"
  },
  {
    "objectID": "ebird.html#sec-ebird-zf",
    "href": "ebird.html#sec-ebird-zf",
    "title": "1  eBird Data",
    "section": "1.2 Zero-filling eBird data",
    "text": "1.2 Zero-filling eBird data\nComplete eBird checklists are extremely valuable because, for all species that weren’t reported, we can infer counts of 0. This allows us to convert eBird from presence only data to detection/non-detection data, which allows for much more robust analyses. Note that we don’t use the term presence/absence data here because a non-detection doesn’t necessarily imply the species was absent, only that observer wasn’t able to detect and identify it.\nWe refer to the process of producing detection/non-detection data as “zero-filling” the eBird data because we’re filling in the missing zeros. Let’s consider observations of Chucao Tapaculo (species code chutap1).\n\nchutap1_detections &lt;- observations %&gt;% \n  filter(species_code == \"chutap1\") %&gt;% \n  select(checklist_id, valid, obs_detected, obs_count)\n\nNext join this set of detections to the complete set of checklists, including detections and non-detections.\n\nchutap1_all &lt;- left_join(checklists, chutap1_detections, by = \"checklist_id\") %&gt;%\n  select(checklist_id, latitude, longitude, year, day_of_year,\n         valid, obs_detected, obs_count)\nhead(chutap1_all)\n#&gt; # A tibble: 6 × 8\n#&gt;   checklist_id latitude longitude  year day_of_year valid obs_detected obs_count\n#&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;       &lt;dbl&gt; &lt;lgl&gt;        &lt;int&gt;     &lt;int&gt;\n#&gt; 1    100062145    -32.9     -71.5  2021         363 NA              NA        NA\n#&gt; 2    100164965    -35.6     -71.0  2021         365 TRUE             1        NA\n#&gt; 3    100241802    -40.6     -73.1  2021         361 NA              NA        NA\n#&gt; 4     10034436    -33.4     -70.2  2012          52 NA              NA        NA\n#&gt; 5    100385722    -32.7     -71.4  2021         355 NA              NA        NA\n#&gt; 6    100390786    -33.3     -70.3  2021         360 NA              NA        NA\n\nFinally, for rows where Chucao Tapaculo was not detected we can replace the missing counts with 0. At this time, we recommend removing any checklists with valid == 0 because there is uncertainty about whether or not the species was detected.\n\nchutap1_zf &lt;- chutap1_all %&gt;% \n  filter(is.na(valid) | valid == 1) %&gt;% \n  mutate(\n    # checklist not in the observations dataset are non-detections\n    obs_detected = coalesce(obs_detected, 0L),\n    # non-detections correspond to a count of 0\n    obs_count = if_else(obs_detected == 1, obs_count, 0)\n  )\n\nWe can now, for example, make a map of Chucao Tapaculo observations in the Chilean region of Los Lagos. We’ll use spatial data that was prepared in advance and provided in the data package.\n\n# load and project gis data\nmap_proj &lt;- \"+proj=laea +lat_0=-40 +lon_0=-72\"\nne_land &lt;- read_sf(\"data/gis-data.gpkg\", \"ne_land\") %&gt;% \n  st_transform(crs = map_proj) %&gt;% \n  st_geometry()\nne_country_lines &lt;- read_sf(\"data/gis-data.gpkg\", \"ne_country_lines\") %&gt;% \n  st_transform(crs = map_proj) %&gt;% \n  st_geometry()\nne_state_lines &lt;- read_sf(\"data/gis-data.gpkg\", \"ne_state_lines\") %&gt;% \n  st_transform(crs = map_proj) %&gt;% \n  st_geometry()\nlos_lagos &lt;- read_sf(\"data/gis-data.gpkg\", \"ne_states\") %&gt;% \n  filter(state_code == \"CL-LL\") %&gt;% \n  st_transform(crs = map_proj) %&gt;% \n  st_geometry()\n\n# prepare ebird data for mapping\nchutap1_sf &lt;- chutap1_zf %&gt;% \n  # convert to spatial points\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;% \n  st_transform(crs = map_proj)\n\n# map\npar(mar = c(0.25, 0.25, 0.25, 0.25))\n# set up plot area\nplot(st_geometry(los_lagos), col = NA, border = NA)\n# contextual gis data\nplot(ne_land, col = \"#cfcfcf\", border = \"#888888\", lwd = 0.5, add = TRUE)\nplot(los_lagos, col = \"#e6e6e6\", border = NA, add = TRUE)\nplot(ne_state_lines, col = \"#ffffff\", lwd = 0.75, add = TRUE)\nplot(ne_country_lines, col = \"#ffffff\", lwd = 1.5, add = TRUE)\n# ebird observations\n# all\nplot(chutap1_sf,\n     pch = 19, cex = 0.1, col = scales::alpha(\"#555555\", 4),\n     add = TRUE)\n#&gt; Warning in plot.sf(chutap1_sf, pch = 19, cex = 0.1, col =\n#&gt; scales::alpha(\"#555555\", : ignoring all but the first attribute\n# detection\nplot(filter(chutap1_sf, obs_detected == 1),\n     pch = 19, cex = 0.3, col = scales::alpha(\"#4daf4a\", 1),\n     add = TRUE)\n#&gt; Warning in plot.sf(filter(chutap1_sf, obs_detected == 1), pch = 19, cex = 0.3,\n#&gt; : ignoring all but the first attribute\n# legend\nlegend(\"bottomright\", bty = \"n\",\n       col = c(\"#555555\", \"#4daf4a\"),\n       legend = c(\"eBird checklists\", \"Chucao Tapaculo sightings\"),\n       pch = 19)\nbox()\npar(new = TRUE, mar = c(0, 0, 3, 0))\ntitle(\"Chucao Tapaculo eBird Observations\\nJune 2007-2021\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExercise\n\n\n\nTry producing zero-filled, detection/non-detection data for another species.\n\n\n\n\n\n\n\n\nSolution\n\n\n\n\n\nFor example, to produce detection/non-detection data for Thorn-tailed Rayadito use:\n\nthtray1_zf &lt;- observations %&gt;% \n  filter(species_code == \"thtray1\") %&gt;% \n  left_join(checklists, ., by = \"checklist_id\") %&gt;% \n  filter(is.na(valid) | valid == 1) %&gt;% \n  mutate(obs_detected = coalesce(obs_detected, 0),\n         obs_count = if_else(obs_detected == 1, obs_count, 0)) %&gt;% \n  select(checklist_id, obs_detected, obs_count)\nhead(thtray1_zf)\n#&gt; # A tibble: 6 × 3\n#&gt;   checklist_id obs_detected obs_count\n#&gt;          &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;\n#&gt; 1    100062145            0         0\n#&gt; 2    100164965            1        NA\n#&gt; 3    100241802            0         0\n#&gt; 4     10034436            0         0\n#&gt; 5    100385722            0         0\n#&gt; 6    100390786            0         0"
  },
  {
    "objectID": "ebird.html#sec-ebird-pred",
    "href": "ebird.html#sec-ebird-pred",
    "title": "1  eBird Data",
    "section": "1.3 Prediction grid",
    "text": "1.3 Prediction grid\nThe ultimate goal of modeling the occurrence or abundance of a species is frequently to produce a map showing the distribution of that species in space. To do so, we need to know the values of our predictor variables over the region that we intend to make predictions. To make this possible, the ERD is distributed with a prediction grid: a regular grid of points covering the entire globe spaced 3km apart for which all the environmental variables have been calculated for the year 2021. Internally, we often refer to this prediction grid as the Spatial Reference Dataset (SRD).\nThe data package for this course contains a subset of the prediction grid for Chile. The file data/ebird_prediction-grid_chile_2021.parquet contains the environmental variables for each point on the grid and the file data/prediction-grid_template.tif is a 3km by 3km raster template where each each cell center is a point on the prediction grid. Let’s start by examining the environmental variables.\n\nprediction_grid &lt;- read_parquet(\"data/ebird_prediction-grid_chile_2021.parquet\")\nglimpse(prediction_grid)\n#&gt; Rows: 151,313\n#&gt; Columns: 83\n#&gt; $ srd_id                           &lt;int&gt; 54237418, 54237419, 54237420, 5423742…\n#&gt; $ longitude                        &lt;dbl&gt; -69.4, -69.4, -69.4, -69.3, -69.3, -6…\n#&gt; $ latitude                         &lt;dbl&gt; -17, -17, -17, -17, -17, -17, -17, -1…\n#&gt; $ eastness_1km_median              &lt;dbl&gt; -0.058229, -0.044364, -0.047317, -0.0…\n#&gt; $ eastness_1km_sd                  &lt;dbl&gt; 0.2181, 0.1155, 0.2455, 0.1704, 0.266…\n#&gt; $ eastness_90m_median              &lt;dbl&gt; 0.06977, 0.03524, 0.00753, -0.02868, …\n#&gt; $ eastness_90m_sd                  &lt;dbl&gt; 0.1154, 0.1539, 0.1562, 0.0899, 0.112…\n#&gt; $ northness_1km_median             &lt;dbl&gt; 0.01759, -0.00286, 0.02578, 0.08451, …\n#&gt; $ northness_1km_sd                 &lt;dbl&gt; 0.236, 0.251, 0.125, 0.278, 0.253, 0.…\n#&gt; $ northness_90m_median             &lt;dbl&gt; -0.00962, -0.01659, 0.00475, -0.01966…\n#&gt; $ northness_90m_sd                 &lt;dbl&gt; 0.1396, 0.1397, 0.0844, 0.1282, 0.136…\n#&gt; $ elev_30m_median                  &lt;dbl&gt; 4271, 4073, 4051, 4008, 4167, 4116, 4…\n#&gt; $ elev_30m_sd                      &lt;dbl&gt; 76.5, 65.6, 104.6, 73.8, 82.4, 34.0, …\n#&gt; $ elev_250m_median                 &lt;dbl&gt; 4269, 4083, 4063, 4018, 4181, 4131, 4…\n#&gt; $ elev_250m_sd                     &lt;dbl&gt; 72.6, 58.7, 98.3, 73.8, 71.4, 30.8, 3…\n#&gt; $ island                           &lt;dbl&gt; 30002, 30002, 30002, 30002, 30002, 30…\n#&gt; $ astwbd_fs_c1_1500_ed             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ astwbd_fs_c1_1500_pland          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ astwbd_fs_c2_1500_ed             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ astwbd_fs_c2_1500_pland          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ astwbd_fs_c3_1500_ed             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ astwbd_fs_c3_1500_pland          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ gp_rtp_1                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ gp_rtp_2                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ gp_rtp_3                         &lt;dbl&gt; 0.0, 505.6, 189.7, 132.4, 0.0, 219.8,…\n#&gt; $ gp_rtp_4                         &lt;dbl&gt; 0.0, 0.0, 586.0, 321.2, 0.0, 678.3, 7…\n#&gt; $ gp_rtp_5                         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ intertidal_fs_c1_1500_ed         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ intertidal_fs_c1_1500_pland      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ ntl_mean                         &lt;dbl&gt; 0.000, 0.000, 0.000, 0.000, 0.000, 0.…\n#&gt; $ ntl_sd                           &lt;dbl&gt; 0.000, 0.000, 0.000, 0.000, 0.000, 0.…\n#&gt; $ mcd12q1_lccs1_fs_c1_1500_ed      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c1_1500_pland   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c2_1500_ed      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c2_1500_pland   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c11_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c11_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c12_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c12_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c13_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c13_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c14_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c14_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c15_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c15_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c16_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c16_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c21_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c21_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c22_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c22_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c31_1500_ed     &lt;dbl&gt; 7.71, 11.99, 8.39, 13.88, 5.40, 7.19,…\n#&gt; $ mcd12q1_lccs1_fs_c31_1500_pland  &lt;dbl&gt; 42.86, 66.67, 80.56, 38.10, 16.67, 78…\n#&gt; $ mcd12q1_lccs1_fs_c32_1500_ed     &lt;dbl&gt; 9.76, 9.59, 6.00, 7.19, 11.39, 0.00, …\n#&gt; $ mcd12q1_lccs1_fs_c32_1500_pland  &lt;dbl&gt; 26.19, 16.67, 13.89, 14.29, 33.33, 0.…\n#&gt; $ mcd12q1_lccs1_fs_c41_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c41_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c42_1500_ed     &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 2.57, 4…\n#&gt; $ mcd12q1_lccs1_fs_c42_1500_pland  &lt;dbl&gt; 0.00, 0.00, 0.00, 0.00, 0.00, 7.14, 2…\n#&gt; $ mcd12q1_lccs1_fs_c43_1500_ed     &lt;dbl&gt; 7.19, 4.80, 3.60, 16.96, 14.39, 4.63,…\n#&gt; $ mcd12q1_lccs1_fs_c43_1500_pland  &lt;dbl&gt; 30.95, 16.67, 5.56, 47.62, 50.00, 14.…\n#&gt; $ mcd12q1_lccs1_fs_c255_1500_ed    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs1_fs_c255_1500_pland &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c25_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c25_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c35_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c35_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c36_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c36_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs3_fs_c27_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs3_fs_c27_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs3_fs_c50_1500_ed     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs3_fs_c50_1500_pland  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs3_fs_c51_1500_ed     &lt;dbl&gt; 1.54, 0.00, 0.00, 0.00, 1.80, 1.54, 1…\n#&gt; $ mcd12q1_lccs3_fs_c51_1500_pland  &lt;dbl&gt; 2.38, 0.00, 0.00, 0.00, 2.78, 2.38, 2…\n#&gt; $ mod44w_oic_fs_c1_1500_ed         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mod44w_oic_fs_c1_1500_pland      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mod44w_oic_fs_c2_1500_ed         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mod44w_oic_fs_c2_1500_pland      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mod44w_oic_fs_c3_1500_ed         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mod44w_oic_fs_c3_1500_pland      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c9_1500_ed      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n#&gt; $ mcd12q1_lccs2_fs_c9_1500_pland   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\nThese variables should be mostly familiar from the ERD, except for srd_id which is a unique identifier for each point on the grid. Next let’s load the raster template using the terra package.\n\nraster_template &lt;- rast(\"data/prediction-grid_template.tif\")\nraster_template\n#&gt; class       : SpatRaster \n#&gt; dimensions  : 5630, 13511, 1  (nrow, ncol, nlyr)\n#&gt; resolution  : 2963, 2963  (x, y)\n#&gt; extent      : -2e+07, 2e+07, -6673060, 1e+07  (xmin, xmax, ymin, ymax)\n#&gt; coord. ref. : +proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs \n#&gt; source      : prediction-grid_template.tif \n#&gt; name        : mask \n#&gt; min value   :    1 \n#&gt; max value   :    1\n\nThis is a global 2.96km by 2.96km square grid in an equal area projection. We can use the terra function rasterize to insert values from the prediction grid into the template for mapping. For example, let’s make a raster dataset of percent cover of evergreen broadleaf forest (mcd12q1_lccs1_fs_c12_1500_pland).\n\nforest_cover &lt;- prediction_grid %&gt;% \n  # convert to spatial object using sf\n  st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326) %&gt;% \n  # transform to the coordinate reference system of the raster\n  st_transform(crs = crs(raster_template)) %&gt;% \n  # rasterize the points using the raster template\n  rasterize(raster_template, field = \"mcd12q1_lccs1_fs_c12_1500_pland\")\n\nNow we can make a simple map of evergreen broadleaf forest for Chile. Not that the raster template is global, but we can use trim() to remove all areas that have missing values for a map of Chile only.\n\nplot(trim(forest_cover), axes = FALSE)\n\n\n\n\n\n\n\n\nThe map looks distorted because the prediction grid uses a sinusoidal projection, which works well for analysis but not for mapping. In the next lesson, we’ll demonstrate how to project data into a coordinate reference system more suitable for mapping."
  },
  {
    "objectID": "ebird.html#sec-ebird-bias",
    "href": "ebird.html#sec-ebird-bias",
    "title": "1  eBird Data",
    "section": "1.4 Spatial and temporal bias",
    "text": "1.4 Spatial and temporal bias\nDespite the strengths of eBird data, species observations collected through citizen science projects exhibit both spatial and temporal bias requiring special care when using them for rigorous analyses. Spatial bias occurs because eBird participants are more likely to be collect data near their homes, in easily accessible areas such as roadsides, or in areas known to be good for birding. Looking at the above map of Chucao Tapaculo observations it’s clear that the eBird checklists are clustered around cities and roads. Temporal bias occurs because participants preferentially collect data when they are available, such as weekends, and at times of year when they expect to observe more birds, notably during the breeding season. We can plot the distribution of checklists over the days of the year to see this bias:\n\nchecklist_per_day &lt;- checklists %&gt;% \n  filter(day_of_year &lt; 366) %&gt;% \n  count(day_of_year)\nggplot(checklist_per_day) +\n  aes(x = day_of_year, y = n) +\n  geom_line() +\n  scale_y_continuous(labels = scales::comma) +\n  labs(x = \"Day of Year\", y = \"# checklists\",\n       title = \"Daily eBird checklists submission\") +\n  theme_gray()\n\n\n\n\n\n\n\n\nThree is a clear seasonal pattern to the number of eBird checklists submitted (fewer checklists in the winter) as well as daily and weekly variation within seasons. In addition, there are two huge spikes in checklists submissions, one in May and the other in October, what do you think could be causing these sudden increases?\nFinally, for most species, there is strong class imbalance in the data, meaning there are usually many more non-detections than detections. As a results, a distribution model predicting that the species is absent everywhere will have high accuracy, but no ecological value. For example, the prevalence rate of Chucao Tapaculo in Chile is only 5%.\n\nmean(chutap1_zf$obs_detected)\n#&gt; [1] 0.0518\n\nTo address these three issues (spatial bias, temporal bias, and class imbalance) we recommend subsampling the data using a technique called case controlled grid sampling. We overlay an equal area 3km by 3km grid over the checklists, then sample one detection and one non-detection from each grid cell for each week of each year. Let’s look at a simple example of how spatial grid sampling works.”\n\n\n\n1. Take one week of eBird observations. Detections are show in green and non-detections are shown in gray.\n\n\n\n\n\n2. Separate the detections and non-detections. In this example, there is a higher density of observations in the lower right corner of the region and the prevalence of detections is 2%.\n\n\n\n\n\n3. Overlay an equal area grid on top of the points, For Status and Trends we use a 3km by 3km grid.\n\n\n\n\n\n4. Sample one checklist from each grid cell.\n\n\n\n\n\n5. Recombine the detections and non-detections. The observations are much more evenly distributed in space and the prevalence of detections has increased from 2% to 20%.\n\n\nThe function grid_sample_stratified() from the ebirdst package is specifically designed to perform case controlled grid sampling on eBird data. For example, let’s apply this technique to the Chucao Tapaculo observations.\n\n# perform case controlled grid sampling\nchutap1_sampled &lt;- grid_sample_stratified(chutap1_zf, \n                                          obs_column = \"obs_detected\")\n\n# how many checklists were removed?\nnrow(chutap1_zf)\n#&gt; [1] 186906\nnrow(chutap1_sampled)\n#&gt; [1] 77200\n\n# how has prevalence changed\nmean(chutap1_zf$obs_detected)\n#&gt; [1] 0.0518\nmean(chutap1_sampled$obs_detected)\n#&gt; [1] 0.073\n\nSo, after sampling, we’re left with 41% of the observations we started with, but the spatial and temporal bias has been significantly reduced.\nWe now have the data and tools necessary to model relative abundance using eBird data, which will be the focus of ?sec-abundance."
  }
]